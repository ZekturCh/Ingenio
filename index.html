<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Generador de Tira de Fotos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background: #f0f0f0;
            margin: 0;
            padding: 20px;
        }
        canvas {
            border: 1px solid #ccc;
            background: white;
        }
    </style>
</head>
<body>
    <h1>Generador de Tira de Fotos</h1>
    <input type="file" id="fileInput" accept="image/*" multiple><br><br>
    <button onclick="generarTira()">Generar Tira</button>
    <button onclick="descargarTira()">Descargar</button>

    <br><br>
    <canvas id="canvas" width="1200" height="1800"></canvas>

    <script>
        let imagenes = [];
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');

        // Configuración de tamaño de fotos
        const anchoFoto = 350; // ancho de cada foto
        const altoFoto = 450;  // alto de cada foto

        // Configuración de posiciones (x, y) de cada foto
        // Aquí puedes mover cada imagen cambiando los valores
        const posiciones = [
            {x: 100, y: 150}, // Foto 1
            {x: 100, y: 650}, // Foto 2
            {x: 100, y: 1150}, // Foto 3
            {x: 750, y: 150}, // Foto 4
            {x: 750, y: 650}, // Foto 5
            {x: 750, y: 1150}  // Foto 6
        ];

        function generarTira() {
            const archivos = document.getElementById('fileInput').files;
            if (archivos.length < 6) {
                alert('Selecciona al menos 6 fotos.');
                return;
            }

            imagenes = [];
            let cargadas = 0;

            // Cargar marco primero
            const marco = new Image();
            marco.src = 'marco.png';
            marco.onload = () => {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(marco, 0, 0, canvas.width, canvas.height);

                for (let i = 0; i < 6; i++) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        const img = new Image();
                        img.src = e.target.result;
                        img.onload = () => {
                            imagenes[i] = img;
                            cargadas++;
                            if (cargadas === 6) {
                                dibujarFotos();
                            }
                        };
                    };
                    reader.readAsDataURL(archivos[i]);
                }
            };
        }

        
                function dibujarFotos() {
                        const margenExterno = 40; // margen lateral exterior
                        const margenEntreColumnas = 80; // espacio entre las dos columnas
                        const margenVertical = 40; // espacio arriba y entre fotos
                        const escalaFotos = 0.8; // 80% del tamaño disponible
                    
                        const anchoDisponible = (canvas.width - (margenExterno * 2) - margenEntreColumnas) / 2;
                        const altoDisponible = canvas.height / 3 - margenVertical * 2;
                    
                        const anchoFoto = anchoDisponible * escalaFotos;
                        const altoFoto = altoDisponible * escalaFotos;
                    
                        imagenes.forEach((img, i) => {
                            const columna = i < 3 ? 0 : 1;
                            const fila = i % 3;
                    
                            const x = margenExterno + columna * (anchoDisponible + margenEntreColumnas);
                            const y = margenVertical + fila * (canvas.height / 3);
                    
                            // Escalar la imagen proporcionalmente
                            const escala = Math.max(anchoFoto / img.width, altoFoto / img.height);
                            const nuevoAncho = img.width * escala;
                            const nuevoAlto = img.height * escala;
                    
                            // Centrar dentro del espacio asignado
                            const offsetX = (anchoDisponible - nuevoAncho) / 2;
                            const offsetY = (altoDisponible - nuevoAlto) / 2;
                    
                            ctx.drawImage(img, x + offsetX, y + offsetY, nuevoAncho, nuevoAlto);
                        });
        }

        function descargarTira() {
            const enlace = document.createElement('a');
            enlace.download = 'tira_fotos.png';
            enlace.href = canvas.toDataURL('image/png');
            enlace.click();
        }
    </script>
</body>
</html>
