<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>PHOTOBOOTH RAICES DEL ALMA</title>
<style>
    body {
        font-family: sans-serif;
        text-align: center;
        background: #f4f4f4;
        padding: 20px;
    }
    input[type="file"] {
        margin: 10px 0;
    }
    canvas {
        border: 1px solid #ccc;
        margin-top: 20px;
        background: white;
    }
    button {
        margin-top: 15px;
        padding: 10px 15px;
        font-size: 16px;
        cursor: pointer;
    }
</style>
</head>
<body>

<h1>Generador de Tiras - HiTi P322W</h1>
<p>Sube tus 6 fotos, se ajustar치n autom치ticamente a la plantilla.</p>

<input type="file" id="fileInput" multiple accept="image/*">
<br>
<button id="generateBtn">Generar Imagen Final</button>
<br>
<canvas id="canvas" width="1844" height="1240"></canvas>
<br>
<a id="downloadLink" style="display:none;" download="tiras_final.png">Descargar Imagen</a>

<script>
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
const fileInput = document.getElementById("fileInput");
const generateBtn = document.getElementById("generateBtn");
const downloadLink = document.getElementById("downloadLink");

let fotos = [];
let plantilla = new Image();
plantilla.src = "plantilla.png"; // Debes tenerla en la misma carpeta

// Posiciones y tama침o de cada ranura (x, y, ancho, alto)
const posiciones = [
    // Izquierda
    {x: 90, y: 50, w: 500, h: 330},
    {x: 90, y: 430, w: 500, h: 330},
    {x: 90, y: 810, w: 500, h: 330},
    // Derecha
    {x: 1250, y: 50, w: 500, h: 330},
    {x: 1250, y: 430, w: 500, h: 330},
    {x: 1250, y: 810, w: 500, h: 330}
];

fileInput.addEventListener("change", (e) => {
    fotos = [];
    const files = Array.from(e.target.files).slice(0, 6);
    files.forEach(file => {
        const reader = new FileReader();
        reader.onload = (evt) => {
            let img = new Image();
            img.onload = () => {
                fotos.push(img);
            };
            img.src = evt.target.result;
        };
        reader.readAsDataURL(file);
    });
});

generateBtn.addEventListener("click", () => {
    if (fotos.length < 6) {
        alert("Debes subir 6 im치genes.");
        return;
    }
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Dibujar las fotos ajustadas
    fotos.forEach((foto, i) => {
        let pos = posiciones[i];
        let escala = Math.max(pos.w / foto.width, pos.h / foto.height);
        let nuevoAncho = foto.width * escala;
        let nuevoAlto = foto.height * escala;
        let offsetX = pos.x - (nuevoAncho - pos.w) / 2;
        let offsetY = pos.y - (nuevoAlto - pos.h) / 2;
        ctx.drawImage(foto, offsetX, offsetY, nuevoAncho, nuevoAlto);
    });

    // Dibujar la plantilla encima
    ctx.drawImage(plantilla, 0, 0, canvas.width, canvas.height);

    // Habilitar descarga
    downloadLink.href = canvas.toDataURL("image/png");
    downloadLink.style.display = "inline-block";
});
</script>

</body>
</html>
