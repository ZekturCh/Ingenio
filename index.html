<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Control en vivo de posiciones</title>
<style>
  body { background: #eee; text-align: center; font-family: Arial; }
  canvas { border: 1px solid #ccc; display: block; margin: 20px auto; background: white; }
  .controls { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: 10px; }
  .control-box { background: #fff; padding: 10px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
  label { font-size: 12px; display: block; }
</style>
</head>
<body>

<h2>Editor en vivo de posiciones</h2>
<canvas id="miCanvas" width="1000" height="800"></canvas>

<div class="controls">
  <div class="control-box">
    <strong>Global</strong>
    <label>Offset X: <input type="range" id="globalX" min="-500" max="500" value="0"> <span id="valGlobalX">0</span></label>
    <label>Offset Y: <input type="range" id="globalY" min="-500" max="500" value="0"> <span id="valGlobalY">0</span></label>
  </div>
</div>

<div class="controls" id="fotoControls"></div>

<script>
const canvas = document.getElementById("miCanvas");
const ctx = canvas.getContext("2d");

// Lista de imágenes
const imagenesSrc = [
  "foto1.jpg", "foto2.jpg", "foto3.jpg",
  "foto4.jpg", "foto5.jpg", "foto6.jpg"
];

// Posiciones iniciales
let posiciones = [
  {x: 100, y: 150},
  {x: 100, y: 350},
  {x: 100, y: 550},
  {x: 700, y: 150},
  {x: 700, y: 350},
  {x: 700, y: 550}
];

// Escala de las imágenes
const escala = 0.8;

// Offset global
let offsetX = 0;
let offsetY = 0;

let imagenes = [];
let cargadas = 0;

// Cargar imágenes
imagenesSrc.forEach((src, i) => {
  const img = new Image();
  img.src = src;
  img.onload = () => {
    imagenes[i] = img;
    cargadas++;
    if (cargadas === imagenesSrc.length) dibujar();
  };
});

// Crear controles individuales
const contenedor = document.getElementById("fotoControls");
posiciones.forEach((pos, i) => {
  const div = document.createElement("div");
  div.className = "control-box";
  div.innerHTML = `
    <strong>Foto ${i+1}</strong>
    <label>X: <input type="range" min="0" max="900" value="${pos.x}" data-i="${i}" data-axis="x">
      <span id="valX${i}">${pos.x}</span></label>
    <label>Y: <input type="range" min="0" max="700" value="${pos.y}" data-i="${i}" data-axis="y">
      <span id="valY${i}">${pos.y}</span></label>
  `;
  contenedor.appendChild(div);
});

// Escuchar sliders globales
document.getElementById("globalX").addEventListener("input", e => {
  offsetX = parseInt(e.target.value);
  document.getElementById("valGlobalX").textContent = offsetX;
  dibujar();
});
document.getElementById("globalY").addEventListener("input", e => {
  offsetY = parseInt(e.target.value);
  document.getElementById("valGlobalY").textContent = offsetY;
  dibujar();
});

// Escuchar sliders individuales
contenedor.addEventListener("input", e => {
  if (e.target.tagName === "INPUT") {
    let i = parseInt(e.target.dataset.i);
    let axis = e.target.dataset.axis;
    posiciones[i][axis] = parseInt(e.target.value);
    document.getElementById(`val${axis.toUpperCase()}${i}`).textContent = posiciones[i][axis];
    dibujar();
  }
});

function dibujar() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  posiciones.forEach((pos, i) => {
    if (imagenes[i]) {
      let nuevoAncho = imagenes[i].width * escala;
      let nuevoAlto = imagenes[i].height * escala;
      ctx.drawImage(imagenes[i], pos.x + offsetX, pos.y + offsetY, nuevoAncho, nuevoAlto);
    }
  });
}
</script>

</body>
</html>

