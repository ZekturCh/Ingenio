<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>INGENIO</title>
  <style>
    body { 
      font-family: Arial, sans-serif; 
      text-align: center; 
      background: #f0f0f0; 
      margin: 0; 
      padding: 20px; 
    }
    canvas { 
      border: 1px solid #ccc; 
      background: #fff; 
      max-width: 95vw; 
      height: auto; 
    }

    input[type="file"] {
  font-size: 1.5rem;   /* letras más grandes */
  padding: 15px;       /* más área clickeable */
  border-radius: 12px; /* esquinas redondeadas */
  background-color: #4FC3F7;
  color: black;
  font-weight: bold;
  cursor: pointer;
}



    .row { 
      margin: 10px 0; 
    }

    .row { margin: 20px 0; }

    /* Estilo botones */
    button {
      background-color: #4FC3F7;  /* Celeste */
      color: black;
      font-weight: bold;
      border: none;
      border-radius: 12px;
      cursor: pointer;

      /* 3 veces más grandes */
      font-size: 2rem;  
      padding: 20px 40px;  
      margin: 10px;
    }
    button:hover {
      background-color: #29b6f6;  /* celeste más intenso al pasar */
      transform: scale(1.05);     /* ligero zoom */
    }
  </style>
</head>
<body>
  <h1>Generador de Tira de Fotos</h1>

  <div class="row">
    <input type="file" id="fileInput" accept="image/*" multiple>
  </div>
  <div class="row">
    <button id="btnGenerar">Generar Tira</button>
    <button id="btnDescargar">Descargar</button>
  </div>

<canvas id="canvas" width="1200" height="1800"></canvas>
<img id="resultado" style="display:none; max-width:95vw;" alt="Resultado">


  <script>
    // Tamaño del lienzo
    const CANVAS_W = 1200;
    const CANVAS_H = 1800;

    // Posiciones fijas para las fotos
    const POSICIONES_MANUALES = [
      {x: 80, y: 290}, 
      {x: 80, y: 650},
      {x: 80, y: 960},
      {x: 650, y: 290},
      {x: 650, y: 650},
      {x: 650, y: 960}
    ];

    // Tamaño fijo de cada foto
    const ANCHO_FOTO = 500;
    const ALTO_FOTO = 350;

    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    canvas.width = CANVAS_W;
    canvas.height = CANVAS_H;

    // Imágenes fijas
    const marco = new Image();
    marco.src = 'FONDOFRA.png';

    const sobre = new Image();
    sobre.src = 'coverRA.png'; // Imagen que quieres encima de todo

    let imagenes = [];

    document.getElementById('btnGenerar').addEventListener('click', generarTira);
    document.getElementById('btnDescargar').addEventListener('click', descargarBlob);

    function generarTira() {
      const files = Array.from(document.getElementById('fileInput').files).slice(0, 6);
      if (files.length < 6) {
        alert('Selecciona exactamente 6 fotos.');
        return;
      }

      imagenes = [];
      let cargadas = 0;

      files.forEach((f, i) => {
        const reader = new FileReader();
        reader.onload = e => {
          const img = new Image();
          img.onload = () => {
            imagenes[i] = img;
            cargadas++;
            if (cargadas === 6) {
              render();
            }
          };
          img.src = e.target.result;
        };
        reader.readAsDataURL(f);
      });
    }

    function render() {
      ctx.clearRect(0, 0, CANVAS_W, CANVAS_H);

      // Fondo blanco
      ctx.fillStyle = '#fff';
      ctx.fillRect(0, 0, CANVAS_W, CANVAS_H);

      // Marco
      ctx.drawImage(marco, 0, 0, CANVAS_W, CANVAS_H);

      // Dibujar fotos
      for (let i = 0; i < 6; i++) {
        const pos = POSICIONES_MANUALES[i];
        if (imagenes[i]) {
          drawImageCover(ctx, imagenes[i], pos.x, pos.y, ANCHO_FOTO, ALTO_FOTO);
        }
      }

      // Dibujar la imagen "sobre" encima de todo
      ctx.drawImage(sobre, 0, 0, CANVAS_W, CANVAS_H);
    }

    function drawImageCover(ctx, img, dx, dy, dW, dH) {
      const sW = img.width;
      const sH = img.height;
      const srcAR = sW / sH;
      const dstAR = dW / dH;

      let sx, sy, sw, sh;
      if (srcAR > dstAR) {
        sh = sH;
        sw = sh * dstAR;
        sx = (sW - sw) / 2;
        sy = 0;
      } else {
        sw = sW;
        sh = sw / dstAR;
        sx = 0;
        sy = (sH - sh) / 2;
      }
      ctx.drawImage(img, sx, sy, sw, sh, dx, dy, dW, dH);
    }

    function descargarBlob() {
      canvas.toBlob(function(blob) {
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = 'foto.png';
          document.body.appendChild(a);
          a.click();
          document.body.removeChild(a);
          URL.revokeObjectURL(url);
      }, 'image/png');
    }

    function render() {
  ctx.clearRect(0, 0, CANVAS_W, CANVAS_H);
  ctx.fillStyle = '#fff';
  ctx.fillRect(0, 0, CANVAS_W, CANVAS_H);

  ctx.drawImage(marco, 0, 0, CANVAS_W, CANVAS_H);

  for (let i = 0; i < 6; i++) {
    const pos = POSICIONES_MANUALES[i];
    if (imagenes[i]) {
      drawImageCover(ctx, imagenes[i], pos.x, pos.y, ANCHO_FOTO, ALTO_FOTO);
    }
  }

  ctx.drawImage(sobre, 0, 0, CANVAS_W, CANVAS_H);

  // --- Aquí conviertes el canvas en imagen ---
  const imgResultado = document.getElementById("resultado");
  imgResultado.src = canvas.toDataURL("image/png");
  imgResultado.style.display = "block";   // la mostramos
  canvas.style.display = "none";          // ocultamos el canvas
}

</script>
</body>
</html>

