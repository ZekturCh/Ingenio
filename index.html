<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Editor de Fotos</title>
<style>
  body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #f0f0f0;
  }
  canvas {
    border: 1px solid black;
    background: white;
  }
  .controls {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 15px;
    margin: 15px 0;
  }
  .control {
    background: white;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 10px;
  }
</style>
</head>
<body>

<h1>Editor de Fotos con Vista Previa</h1>

<input type="file" id="fileInput" multiple accept="image/*"><br><br>

<div class="controls" id="controlPanel"></div>

<canvas id="canvas" width="1200" height="800"></canvas><br><br>

<button onclick="descargarImagen()">Descargar Imagen</button>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
const fileInput = document.getElementById('fileInput');
const controlPanel = document.getElementById('controlPanel');

let imagenes = [];
let posiciones = [
  {x: 120, y: 150, width: 250, height: 180}, // Foto 1
  {x: 120, y: 360, width: 250, height: 180}, // Foto 2
  {x: 120, y: 570, width: 250, height: 180}, // Foto 3
  {x: 700, y: 150, width: 250, height: 180}, // Foto 4
  {x: 700, y: 360, width: 250, height: 180}, // Foto 5
  {x: 700, y: 570, width: 250, height: 180}  // Foto 6
];

fileInput.addEventListener('change', function(e) {
  const files = e.target.files;
  imagenes = [];
  
  Array.from(files).forEach((file, i) => {
    const reader = new FileReader();
    reader.onload = function(event) {
      const img = new Image();
      img.onload = function() {
        imagenes[i] = img;
        if (imagenes.length === files.length) {
          generarControles();
          dibujarCanvas();
        }
      }
      img.src = event.target.result;
    }
    reader.readAsDataURL(file);
  });
});

function generarControles() {
  controlPanel.innerHTML = "";
  posiciones.forEach((pos, index) => {
    let div = document.createElement('div');
    div.className = 'control';
    div.innerHTML = `
      <h4>Foto ${index+1}</h4>
      X: <input type="number" value="${pos.x}" onchange="actualizarPos(${index}, 'x', this.value)"><br>
      Y: <input type="number" value="${pos.y}" onchange="actualizarPos(${index}, 'y', this.value)"><br>
      Ancho: <input type="number" value="${pos.width}" onchange="actualizarPos(${index}, 'width', this.value)"><br>
      Alto: <input type="number" value="${pos.height}" onchange="actualizarPos(${index}, 'height', this.value)">
    `;
    controlPanel.appendChild(div);
  });
}

function actualizarPos(index, prop, valor) {
  posiciones[index][prop] = parseInt(valor);
  dibujarCanvas();
}

function dibujarCanvas() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  
  posiciones.forEach((pos, index) => {
    if (imagenes[index]) {
      ctx.drawImage(imagenes[index], pos.x, pos.y, pos.width, pos.height);
    }
  });
}

function descargarImagen() {
  const enlace = document.createElement('a');
  enlace.download = 'foto_final.png';
  enlace.href = canvas.toDataURL();
  enlace.click();
}
</script>

</body>
</html>

